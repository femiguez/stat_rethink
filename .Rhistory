priors2 <- prior(normal(80, 30), nlpar = "Asym", coef = "Intercept") +
prior(normal(0, 15), nlpar = "Asym", coef = "rotation4y") +
prior(normal(50, 20), nlpar = "xmid", coef = "Intercept") +
prior(normal(0, 20), nlpar = "xmid", coef = "rotation4y") +
prior(normal(10, 5), nlpar = "scal", coef = "Intercept") +
prior(normal(0, 7), nlpar = "scal", coef = "rotation4y") +
prior(student_t(3, 0, 30), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 11), nlpar = "xmid", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 4), nlpar = "scal", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(10, 0, 5), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f:plot_id") +
prior(uniform(0, 2), nlpar = "tau", class = "b", lb = 0, ub = 2) +
prior(uniform(0.5, 1.5), nlpar = "theta", lb = 0.5, ub = 1.5)
brm2 <- brm(bf2, data = rd_maxG, seed = 98, prior = priors2,
iter = 2000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
plot(brm2, "^b_tau")
plot(brm2, "^b_theta")
plot(brm2, "^b_tau")
fm4
intervals(fm4)
priors2 <- prior(normal(80, 30), nlpar = "Asym", coef = "Intercept") +
prior(normal(0, 15), nlpar = "Asym", coef = "rotation4y") +
prior(normal(50, 20), nlpar = "xmid", coef = "Intercept") +
prior(normal(0, 20), nlpar = "xmid", coef = "rotation4y") +
prior(normal(10, 5), nlpar = "scal", coef = "Intercept") +
prior(normal(0, 7), nlpar = "scal", coef = "rotation4y") +
prior(student_t(3, 0, 30), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 11), nlpar = "xmid", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 4), nlpar = "scal", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(10, 0, 5), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f:plot_id") +
prior(uniform(0.2, 1.2), nlpar = "tau", class = "b", lb = 0.2, ub = 1.2) +
prior(uniform(0.5, 1.5), nlpar = "theta", lb = 0.5, ub = 1.5)
brm2 <- brm(bf2, data = rd_maxG, seed = 98, prior = priors2,
iter = 2000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
plot(brm2, "^b_tau")
plot(brm2, "^b_theta")
fm4
sigma(fm4)^2
?varPower
## Sounds like we really need to model sigma
bf2 <- bf(rootdepth_cm ~ eta, nl = TRUE) +
nlf(eta ~ Asym / (1 + exp((xmid - dap)/scal))) +
lf(Asym ~ rotation + (1 | year.f/plot_id)) +
lf(xmid + scal ~ rotation + (1 | year.f)) +
nlf(sigma ~ eta^(2 * theta)) +
lf(theta ~ 1)
priors2 <- prior(normal(80, 30), nlpar = "Asym", coef = "Intercept") +
prior(normal(0, 15), nlpar = "Asym", coef = "rotation4y") +
prior(normal(50, 20), nlpar = "xmid", coef = "Intercept") +
prior(normal(0, 20), nlpar = "xmid", coef = "rotation4y") +
prior(normal(10, 5), nlpar = "scal", coef = "Intercept") +
prior(normal(0, 7), nlpar = "scal", coef = "rotation4y") +
prior(student_t(3, 0, 30), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 11), nlpar = "xmid", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 4), nlpar = "scal", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(10, 0, 5), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f:plot_id") +
prior(uniform(0.5, 1.5), nlpar = "theta", lb = 0.5, ub = 1.5)
brm2 <- brm(bf2, data = rd_maxG, seed = 98, prior = priors2,
iter = 2000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
plot(brm2, "^b_theta")
fm4
fitted(fm4)
fttd <- fitted(fm4)
stds <- fttd ^ (2 * 0.71)
rsds <- resid(stds)
rsds <- resid(fm4)
attributes(rsds)
attr(rsds, "std")
simulate_nlme
simulate_nlme_one
nlraa::simulate_nlme_one
nlraa:::simulate_nlme_one
fttd <- fitted(fm4)
stds <- attr(fm4$residuals, "std")
stds <- attr(fm4$residuals, "std")
fm4
fm4$varFix
fm4$varFix
fm4$modelStruct$varStruct
fm4$modelStruct$varStruct[[1]]
stds2 <- sigma(fm4) * fttd ^ (2 * delt)
###
## Looking at residuals
fttd <- fitted(fm4)
stds <- attr(fm4$residuals, "std")
delt <- fm4$modelStruct$varStruct[[1]]
stds2 <- sigma(fm4) * fttd ^ (2 * delt)
plot(stds, stds2)
###
## Looking at residuals
fttd <- fitted(fm4)
stds <- attr(fm4$residuals, "std")
delt <- fm4$modelStruct$varStruct[[1]]
stds2 <- sqrt(sigma(fm4)^2 * fttd ^ (2 * delt))
plot(stds, stds2)
abline(0,1x)
abline(0,1)
sigma(fm4)^2
lf(theta ~ 1)
priors2 <- prior(normal(80, 30), nlpar = "Asym", coef = "Intercept") +
prior(normal(0, 15), nlpar = "Asym", coef = "rotation4y") +
prior(normal(50, 20), nlpar = "xmid", coef = "Intercept") +
prior(normal(0, 20), nlpar = "xmid", coef = "rotation4y") +
prior(normal(10, 5), nlpar = "scal", coef = "Intercept") +
prior(normal(0, 7), nlpar = "scal", coef = "rotation4y") +
prior(student_t(3, 0, 30), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 11), nlpar = "xmid", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 4), nlpar = "scal", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(10, 0, 5), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f:plot_id") +
prior(uniform(0.01, 1), nlpar = "tau2", lb = 0.01, ub = 1)
priors2 <- prior(normal(80, 30), nlpar = "Asym", coef = "Intercept") +
prior(normal(0, 15), nlpar = "Asym", coef = "rotation4y") +
prior(normal(50, 20), nlpar = "xmid", coef = "Intercept") +
prior(normal(0, 20), nlpar = "xmid", coef = "rotation4y") +
prior(normal(10, 5), nlpar = "scal", coef = "Intercept") +
prior(normal(0, 7), nlpar = "scal", coef = "rotation4y") +
prior(student_t(3, 0, 30), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 11), nlpar = "xmid", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 4), nlpar = "scal", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(10, 0, 5), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f:plot_id") +
prior(uniform(0.01, 1), nlpar = "tau2", lb = 0.01, ub = 1) +
prior(uniform(0.5, 1.5), nlpar = "theta", lb = 0.5, ub = 1.5)
brm2 <- brm(bf2, data = rd_maxG, seed = 98, prior = priors2,
iter = 2000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
lf(theta ~ 1)
## Sounds like we really need to model sigma
bf2 <- bf(rootdepth_cm ~ eta, nl = TRUE) +
nlf(eta ~ Asym / (1 + exp((xmid - dap)/scal))) +
lf(Asym ~ rotation + (1 | year.f/plot_id)) +
lf(xmid + scal ~ rotation + (1 | year.f)) +
nlf(sigma ~ sqrt(tau2 * eta^(2 * theta))) +
lf(tau2 ~ 1) +
lf(theta ~ 1)
priors2 <- prior(normal(80, 30), nlpar = "Asym", coef = "Intercept") +
prior(normal(0, 15), nlpar = "Asym", coef = "rotation4y") +
prior(normal(50, 20), nlpar = "xmid", coef = "Intercept") +
prior(normal(0, 20), nlpar = "xmid", coef = "rotation4y") +
prior(normal(10, 5), nlpar = "scal", coef = "Intercept") +
prior(normal(0, 7), nlpar = "scal", coef = "rotation4y") +
prior(student_t(3, 0, 30), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 11), nlpar = "xmid", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 4), nlpar = "scal", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(10, 0, 5), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f:plot_id") +
prior(uniform(0.01, 1), nlpar = "tau2", lb = 0.01, ub = 1) +
prior(uniform(0.5, 1.5), nlpar = "theta", lb = 0.5, ub = 1.5)
brm2 <- brm(bf2, data = rd_maxG, seed = 98, prior = priors2,
iter = 2000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
plot(brm2, "^b_tau")
plot(brm2, "^b_theta")
plot(brm2, "^b_tau")
delt
###
## Looking at residuals
fttd <- fitted(fm4)
stds <- attr(fm4$residuals, "std")
theta <- fm4$modelStruct$varStruct[[1]]
stds2 <- sqrt(sigma(fm4)^2 * fttd ^ (2 * theta))
plot(stds, stds2)
abline(0,1)
fm4
intervals(fm4)
priors2 <- prior(normal(80, 30), nlpar = "Asym", coef = "Intercept") +
prior(normal(0, 15), nlpar = "Asym", coef = "rotation4y") +
prior(normal(50, 20), nlpar = "xmid", coef = "Intercept") +
prior(normal(0, 20), nlpar = "xmid", coef = "rotation4y") +
prior(normal(10, 5), nlpar = "scal", coef = "Intercept") +
prior(normal(0, 7), nlpar = "scal", coef = "rotation4y") +
prior(student_t(3, 0, 30), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 11), nlpar = "xmid", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 4), nlpar = "scal", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(10, 0, 5), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f:plot_id") +
prior(uniform(0.01, 1), nlpar = "tau2", lb = 0.01, ub = 1) +
prior(uniform(0.5, 1), nlpar = "theta", lb = 0.5, ub = 1)
brm2 <- brm(bf2, data = rd_maxG, seed = 987, prior = priors2,
iter = 2000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
plot(brm2, "^b_tau")
plot(brm2, "^b_theta")
brm2 <- brm(bf2, data = rd_maxG, seed = 9876, prior = priors2,
iter = 3000, cores = 2, chains = 2,
control = list(adapt_delta = 0.95))
plot(brm2, "^b_tau")
plot(brm2, "^b_theta")
brm2 <- brm(bf2, data = rd_maxG, seed = 9876, prior = priors2,
iter = 3000, cores = 2, chains = 2,
control = list(adapt_delta = 0.8))
plot(brm2, "^b_tau")
plot(brm2, "^b_theta")
fm5 <- update(fm4, weights = varFixed(~dap))
?varFixed
fm4
fm5 <- update(fm3, weights = varFixed(~dap))
?varPower
fm5 <- update(fm3, weights = varPower(form = ~dap))
fm5 <- update(fm3, weights = varFixed(~dap))
fm5 <- update(fm3, weights = varFixed(~dap | rotation))
rd_maxG
dim(rd_maxG)
?varFixed
summary(rd_maxG)
fm5 <- update(fm3, weights = varFixed(~dop))
fm3
fm4
fm4
summary(rd_maxG)
fm5 <- update(fm3, weights = varFixed(~doy))
class(rd_maxG$dap)
plot(density(rd_maxG$dap))
fm5 <- update(fm3, weights = varFixed(~dap))
## Sounds like we really need to model sigma
bf2 <- bf(rootdepth_cm ~ eta, nl = TRUE) +
nlf(eta ~ Asym / (1 + exp((xmid - dap)/scal))) +
lf(Asym ~ rotation + (1 | year.f/plot_id)) +
lf(xmid + scal ~ rotation + (1 | year.f)) +
nlf(sigma ~ sqrt(tau2 * dap^(2 * theta))) +
lf(tau2 ~ 1) +
lf(theta ~ 1)
priors2 <- prior(normal(80, 30), nlpar = "Asym", coef = "Intercept") +
prior(normal(0, 15), nlpar = "Asym", coef = "rotation4y") +
prior(normal(50, 20), nlpar = "xmid", coef = "Intercept") +
prior(normal(0, 20), nlpar = "xmid", coef = "rotation4y") +
prior(normal(10, 5), nlpar = "scal", coef = "Intercept") +
prior(normal(0, 7), nlpar = "scal", coef = "rotation4y") +
prior(student_t(3, 0, 30), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 11), nlpar = "xmid", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 4), nlpar = "scal", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(10, 0, 5), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f:plot_id") +
prior(uniform(0.01, 1), nlpar = "tau2", lb = 0.01, ub = 1) +
prior(uniform(0, 5), nlpar = "theta", lb = 0, ub = 5)
brm2 <- brm(bf2, data = rd_maxG, seed = 9876, prior = priors2,
iter = 3000, cores = 2, chains = 2,
control = list(adapt_delta = 0.8))
prior_summary(brm2)
brm1
## Plots look good
plot(brm1, "^b_Asym")
plot(brm1, "^b_xmid")
plot(brm1, "^b_scal")
plot(brm1, "^sd_")
plot(brm1, "sigma")
## Compare parameters
## nlme fm3 vs. brm1
round(fixef(fm3), 3)
round(fixef(brm1), 3)
ggplot(data = ndat2, aes(x = dap, y = Estimate, color = rotation)) +
geom_line() +
geom_ribbon(aes(ymin = Q5, ymax = Q95, fill = rot_trt), alpha = 0.2)
## Let's look at predictions
ndat <- expand.grid(rotation = unique(rd_maxG$rotation),
dap = seq(0, 85, length.out = 50))
pp <- predict(brm1, newdata = ndat, re_formula = NA, probs = c(0.05, 0.95))
ndat2 <- cbind(ndat, pp)
fm2
ggplot(rd_maxG, aes(x = dap, y = rootdepth_cm, color = rotation)) +
geom_point() +
geom_line(aes(y = prd0)) +
geom_ribbon(aes(ymin = lwr0, ymax = upr0, fill = rotation), alpha = 0.3)
## Test for asymptote
emmeans(fm4, ~rotation, param = "Asym")
contrast(emmeans(fm4, ~rotation, param = "Asym"), "pairwise")
ggplot(rd_maxG, aes(x = dap, y = rootdepth_cm, color = rotation)) +
facet_wrap(~ year.f) +
geom_point() +
geom_line(aes(y = prd1)) +
geom_ribbon(aes(ymin = lwr1, ymax = upr1, fill = rotation), alpha = 0.3)
rstd1 <- abs(rstudent_t(1e4, 100, 0, 10))
rexp1 <- rexp(1e4, 1/10)
c(max(rstd1), max(rexp1))
ggplot() +
geom_density(aes(x = rstd1, color = "Student-t")) +
geom_density(aes(x = rexp1, color = "Exponential"))
fm3
intervals(fm3)
## How does the student-t distribution compare to the exponential?
## This is an example for sigma
rstd1 <- abs(rstudent_t(1e4, 3, 0, 30))
rexp1 <- rexp(1e4, 1/10)
c(max(rstd1), max(rexp1))
ggplot() +
geom_density(aes(x = rstd1, color = "Student-t")) +
geom_density(aes(x = rexp1, color = "Exponential"))
## How does the student-t distribution compare to the exponential?
## This is an example for sigma
rstd1 <- abs(rstudent_t(1e4, 100, 0, 30))
rexp1 <- rexp(1e4, 1/30)
c(max(rstd1), max(rexp1))
ggplot() +
geom_density(aes(x = rstd1, color = "Student-t")) +
geom_density(aes(x = rexp1, color = "Exponential"))
## How does the student-t distribution compare to the exponential?
## This is an example for sigma
rstd1 <- abs(rstudent_t(1e4, 3, 0, 30))
rexp1 <- rexp(1e4, 1/30)
c(max(rstd1), max(rexp1))
ggplot() +
geom_density(aes(x = rstd1, color = "Student-t")) +
geom_density(aes(x = rexp1, color = "Exponential"))
## How does the student-t distribution compare to the exponential?
## This is an example for sigma
rstd1 <- abs(rstudent_t(1e4, 100, 0, 30))
rexp1 <- rexp(1e4, 1/30)
c(max(rstd1), max(rexp1))
ggplot() +
geom_density(aes(x = rstd1, color = "Student-t")) +
geom_density(aes(x = rexp1, color = "Exponential"))
## Setting up priors for brms
priors <- prior(normal(80, 30), nlpar = "Asym", coef = "Intercept") +
prior(normal(0, 15), nlpar = "Asym", coef = "rotation4y") +
prior(normal(50, 20), nlpar = "xmid", coef = "Intercept") +
prior(normal(0, 20), nlpar = "xmid", coef = "rotation4y") +
prior(normal(10, 5), nlpar = "scal", coef = "Intercept") +
prior(normal(0, 7), nlpar = "scal", coef = "rotation4y") +
prior(student_t(3, 0, 30), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 11), nlpar = "xmid", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 4), nlpar = "scal", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(10, 0, 5), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f:plot_id") +
prior(student_t(100, 0, 10), class = "sigma")
brm1
fm3
## Plots look good
plot(brm1, "^b_Asym")
plot(brm1, "^b_xmid")
plot(brm1, "^b_scal")
plot(brm1, "^sd_")
round(fixef(fm3), 3)
round(fixef(brm1), 3)
ggplot(data = ndat2, aes(x = dap, y = Estimate, color = rotation)) +
geom_line() +
geom_ribbon(aes(ymin = Q5, ymax = Q95, fill = rot_trt), alpha = 0.2)
ggplot(data = ndat2, aes(x = dap, y = Estimate, color = rot_trt)) +
geom_line() +
geom_ribbon(aes(ymin = Q5, ymax = Q95, fill = rot_trt), alpha = 0.2)
brm1
## Let's look at predictions
ndat <- expand.grid(rot_trt = unique(rd_maxG$rotation),
dap = seq(0, 85, length.out = 50))
pp <- predict(brm1, newdata = ndat, re_formula = NA, probs = c(0.05, 0.95))
ndat2 <- cbind(ndat, pp)
ggplot(data = ndat2, aes(x = dap, y = Estimate, color = rot_trt)) +
geom_line() +
geom_ribbon(aes(ymin = Q5, ymax = Q95, fill = rot_trt), alpha = 0.2)
fm4
## Plots look good
plot(brm1, "^b_Asym")
ggplot(rd_maxG, aes(x = dap, y = rootdepth_cm, color = rotation)) +
facet_wrap(~ year.f) +
geom_point() +
geom_line(aes(y = prd1)) +
geom_ribbon(aes(ymin = lwr1, ymax = upr1, fill = rotation), alpha = 0.3)
## Test for asymptote
emmeans(fm4, ~rotation, param = "Asym")
contrast(emmeans(fm4, ~rotation, param = "Asym"), "pairwise")
plot(emmeans(fm4, ~rotation, param = "Asym"))
anova(fm4)
emmeans(fm4, ~rotation, param = "xmid")
contrast(emmeans(fm4, ~rotation, param = "xmid"), "pairwise")
plot(emmeans(fm4, ~rotation, param = "xmid"))
ggplot(rd_maxG, aes(x = dap, y = rootdepth_cm, color = rotation)) +
facet_wrap(~ year.f) +
geom_point() +
geom_line(aes(y = prd1)) +
geom_ribbon(aes(ymin = lwr1, ymax = upr1, fill = rotation), alpha = 0.3)
plot(rd_maxG)
ggplot(rd_maxG, aes(x = dap, y = rootdepth_cm, color = rotation)) +
facet_wrap(~ year.f) +
geom_point() +
geom_line(aes(y = prd1)) +
geom_ribbon(aes(ymin = lwr1, ymax = upr1, fill = rotation), alpha = 0.3)
head(sim1)
dim(sim1)
sim1 <- simulate_nlme(fm4, level = 1, nsim = 1e3, value = "data.frame")
dim(sim1)
head(sim1)
brm1 <- brm(bf1, data = rd_maxG, seed = 98, prior = priors,
iter = 10000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
## Setting up priors for brms
priors <- prior(normal(80, 30), nlpar = "Asym", coef = "Intercept") +
prior(normal(0, 15), nlpar = "Asym", coef = "rotation4y") +
prior(normal(50, 20), nlpar = "xmid", coef = "Intercept") +
prior(normal(0, 20), nlpar = "xmid", coef = "rotation4y") +
prior(normal(10, 5), nlpar = "scal", coef = "Intercept") +
prior(normal(0, 7), nlpar = "scal", coef = "rotation4y") +
prior(student_t(3, 0, 30), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 11), nlpar = "xmid", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(3, 0, 4), nlpar = "scal", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(10, 0, 5), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f:plot_id") +
prior(student_t(100, 0, 10), class = "sigma")
## Some of this is based on the insight from the NLME
bf1 <- bf(rootdepth_cm ~ Asym / (1 + exp((xmid - dap)/scal)),
Asym ~ rotation + (1 | year.f/plot_id),
xmid + scal ~ rotation + (1 | year.f),
nl = TRUE)
brm1 <- brm(bf1, data = rd_maxG, seed = 98, prior = priors,
iter = 10000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
## Plots look good
plot(brm1, "^b_Asym")
plot(brm1, "^b_xmid")
plot(brm1, "^b_scal")
plot(brm1, "^sd_")
plot(brm1, "sigma")
brm1
brm1 <- brm(bf1, data = rd_maxG, seed = 98, prior = priors,
iter = 11000, cores = 3, chains = 3,
control = list(adapt_delta = 0.96))
brm1 <- brm(bf1, data = rd_maxG, seed = 98, prior = priors,
iter = 12000, cores = 3, chains = 3,
control = list(adapt_delta = 0.97))
## Plots look good
plot(brm1, "^b_Asym")
plot(brm1, "^b_xmid")
plot(brm1, "^b_scal")
plot(brm1, "^sd_")
plot(brm1, "sigma")
plot(conditional_effects(brm1, effects = "rotation"), points = TRUE)
plot(conditional_effects(brm1), points = TRUE)
?conditional_effects
brm1 <- brm(bf1, data = rd_maxG, seed = 98, prior = priors,
iter = 1000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
brm1
plot(conditional_effects(brm1), points = TRUE)
plot(conditional_effects(brm1, effects = "rotation"), points = TRUE)
?conditional_effects
brm1 <- brm(bf1, data = rd_maxG, seed = 98, prior = priors,
iter = 2000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
## Plots look good
plot(brm1, "^b_Asym")
plot(brm1, "^b_xmid")
plot(brm1, "^b_scal")
plot(brm1, "^sd_")
plot(brm1, "sigma")
pairs(brm1, "^b_")
brm1 <- brm(bf1, data = rd_maxG, seed = 987, prior = priors,
iter = 3000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
brm1
brm1 <- brm(bf1, data = rd_maxG, seed = 98, prior = priors,
iter = 4000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
## Plots look good
plot(brm1, "^b_Asym")
plot(brm1, "^b_xmid")
plot(brm1, "^b_scal")
plot(brm1, "^sd_")
plot(brm1, "sigma")
plot(brm1, "^sd_")
brm1
## Setting up priors for brms
priors <- prior(normal(80, 30), nlpar = "Asym", coef = "Intercept") +
prior(normal(0, 15), nlpar = "Asym", coef = "rotation4y") +
prior(normal(50, 20), nlpar = "xmid", coef = "Intercept") +
prior(normal(0, 20), nlpar = "xmid", coef = "rotation4y") +
prior(normal(10, 5), nlpar = "scal", coef = "Intercept") +
prior(normal(0, 7), nlpar = "scal", coef = "rotation4y") +
prior(student_t(4, 0, 30), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(4, 0, 15), nlpar = "xmid", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(4, 0, 4), nlpar = "scal", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(10, 0, 5), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f:plot_id") +
prior(student_t(100, 0, 10), class = "sigma")
## Some of this is based on the insight from the NLME
bf1 <- bf(rootdepth_cm ~ Asym / (1 + exp((xmid - dap)/scal)),
Asym ~ rotation + (1 | year.f/plot_id),
xmid + scal ~ rotation + (1 | year.f),
nl = TRUE)
brm1 <- brm(bf1, data = rd_maxG, seed = 98, prior = priors,
iter = 5000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
## Plots look good
plot(brm1, "^b_Asym")
plot(brm1, "^b_xmid")
plot(brm1, "^b_scal")
plot(brm1, "^sd_")
## Setting up priors for brms
priors <- prior(normal(80, 30), nlpar = "Asym", coef = "Intercept") +
prior(normal(0, 15), nlpar = "Asym", coef = "rotation4y") +
prior(normal(50, 20), nlpar = "xmid", coef = "Intercept") +
prior(normal(0, 20), nlpar = "xmid", coef = "rotation4y") +
prior(normal(10, 5), nlpar = "scal", coef = "Intercept") +
prior(normal(0, 7), nlpar = "scal", coef = "rotation4y") +
prior(student_t(5, 0, 30), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(5, 0, 15), nlpar = "xmid", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(5, 0, 4), nlpar = "scal", coef = "Intercept", class = "sd", group = "year.f") +
prior(student_t(10, 0, 5), nlpar = "Asym", coef = "Intercept", class = "sd", group = "year.f:plot_id") +
prior(student_t(100, 0, 10), class = "sigma")
## Some of this is based on the insight from the NLME
bf1 <- bf(rootdepth_cm ~ Asym / (1 + exp((xmid - dap)/scal)),
Asym ~ rotation + (1 | year.f/plot_id),
xmid + scal ~ rotation + (1 | year.f),
nl = TRUE)
brm1 <- brm(bf1, data = rd_maxG, seed = 99, prior = priors,
iter = 5000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
brm1 <- brm(bf1, data = rd_maxG, seed = 98, prior = priors,
iter = 1000, cores = 3, chains = 3,
control = list(adapt_delta = 0.95))
## Plots look good
plot(brm1, "^b_Asym")
plot(brm1, "^b_xmid")
plot(brm1, "^b_scal")
plot(brm1, "^sd_")
plot(brm1, "sigma")
plot(brm1, "^sd_")
plot(brm1, "sigma")
pairs(brm1, "^b_")
plot(conditional_effects(brm1), points = TRUE)
